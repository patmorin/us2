\documentclass[kpfonts]{patmorin}
\listfiles
\usepackage{pat}
\usepackage{paralist}
\usepackage{dsfont}  % for \mathds{A}
\usepackage[utf8x]{inputenc}
\usepackage{skull}
\usepackage{graphicx}
\usepackage[noend]{algorithmic}
\usepackage[normalem]{ulem}
\usepackage{cancel}
\usepackage{enumitem}
\usepackage{todonotes}

\usepackage[longnamesfirst,numbers,sort&compress]{natbib}


\definecolor{brightmaroon}{rgb}{0.76, 0.13, 0.28}
\definecolor{linkblue}{rgb}{0, 0.337, 0.227}
\newcommand{\defin}[1]{\emph{\color{brightmaroon}#1}}
\setlength{\parskip}{1ex}

\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\tw}{tw}
\DeclareMathOperator{\td}{td}
\DeclareMathOperator{\stw}{stw}
\DeclareMathOperator{\ltw}{ltw}
\DeclareMathOperator{\pw}{pw}
\DeclareMathOperator{\lpw}{lpw}
\DeclareMathOperator{\lhptw}{lhp-tw}
\DeclareMathOperator{\lhppw}{lhp-pw}

% \newcommand{\defin}[1]{\emph{#1}}

\title{\MakeUppercase{A Unique Superior is Still One Too Many}}
\author{Bra\v{c} 2023 Gang}


\newcommand{\rn}[1]{\chi_{\operatorname{#1-vr}}}
\newcommand{\irn}{\rn{\infty}}
% \newcommand{\trn}{\rn{2}}
\newcommand{\trn}{\chi_{\mathrm{us}}}
\newcommand{\lrn}{\rn{\ell}}
\newcommand{\dtcn}{\bar{\chi}_2}
\newcommand{\dlcn}{\bar{\chi}_\ell}
\newcommand{\scn}{\chi_{\star}}


% \pagenumbering{roman}
\begin{document}

\maketitle

\begin{abstract}
  A \defin{unique-superior colouring} (also known as a \defin{$2$-vertex-ranking} or \defin{restricted star colouring}) is a mapping $\varphi:V(G)\to\N$ of the vertices of a graph $G$ to integer colours so that for any edge $uv$, $\varphi(u)\neq \varphi(v)$ and for any $3$-vertex path $uvw$, $\phi(u)\neq\varphi(w)$ or $\varphi(v)>\varphi(u)$.  For a graph $G$, the unique-superior chromatic number $\trn(G)$ is the minimum value of $k$ such that $G$ has a us-colouring $\varphi:V(G)\to\{1,\ldots,k\}$.  We show that, for any $\epsilon >0$ there exists $c:=c\epsilon$ such that every $n$-vertex $d$-degenerate graph $G$ has $\trn(G) \le c n^{3/2+\epsilon}$.
\end{abstract}


% \tableofcontents
%
% \newpage
% \pagenumbering{arabic}

\section{Introduction}

A \defin{unique-superior colouring} (also known as a \defin{$2$-vertex-ranking} or \defin{restricted star colouring}) is a mapping $\varphi:V(G)\to\N$ of the vertices of a graph $G$ to integer colours so that for any edge $uv$, $\varphi(u)\neq \varphi(v)$ and for any $3$-vertex path $uvw$, $\phi(u)\neq\varphi(w)$ or $\varphi(v)>\varphi(u)$.  For a graph $G$, the unique-superior chromatic number $\trn(G)$ is the minimum value of $k$ such that $G$ has a us-colouring $\varphi:V(G)\to\{1,\ldots,k\}$.

\citet{karpas.neiman.ea:on} showed that for every $d$-degenerate $n$-vertex graph $G$, $\trn(G)\in O(d\sqrt{n})$ and that there exists $2$-degenerate $n$-vertex graphs with $\trn(G)\in\Omega(n^{1/3})$.  They leave the question of closing the gap between these bounds as an open problem. In the current paper we give a colouring procedure that essentially matches their lower bound:

\begin{thm}\label{d_degenerate_upper_bound}
  For any $\epsilon >0$ and any $d\ge 1$ there exists $c:=c(\epsilon,d)$ such that every $n$-vertex $d$-degenerate graph $G$ has $\trn(G) \le c n^{1/3+\epsilon}$.
\end{thm}

\section{Proof of \cref{d_degenerate_upper_bound}}

A graph $H$ is \defin{$(\beta,\delta)$-good} if there exists a distribution $\mathcal{D}$ over us-colourings of $H$ such that when $\varphi$ drawn from $\mathcal{D}$ we have
$\E[|\varphi(V(H))|]\le \beta$, and $\Pr(\varphi(v)=\varphi(w))\le\delta$ for all distinct $v,w\in V(H)$.

% We reduce the proof of the general case a bipartite problem, which we consider here.

\begin{lem}
  For any $\epsilon >0$, any integer $d\ge 1$, there exists $c:=c(\epsilon,d)$, and $\alpha:=\alpha(\epsilon,d)$ such that the following holds for every integer $n\ge 1$, every $\beta \ge 1$, and every graph $G$ with a vertex-partition $(A,B)$ where $B$ is an independent set of size at most $n$ and with $\deg(v)\le d$ for each $v\in B$,  if $G[A]$ is $(\beta,\alpha n^{-1/3-\epsilon/2})$-good, then  $G$ is $(\beta+cn^{1/3+\epsilon},\alpha n^{-1/3-\epsilon/2})$-good.
\end{lem}

\begin{proof}
  Fix some $\epsilon >0$, integer $d\ge 1$, and let $c:=?$ and $\alpha:=?$. Let $n$, $\beta$, $G$, $A$, $B$, be as in the statement of the lemma.  Let $\mathcal{D}$ be a distribution over us-colourings of $G[A]$ witnessing the fact that $G[A]$ is $(\beta,\alpha n^{-1/3-\epsilon/2})$-good and let $\varphi$ be a us-colouring of $G[A]$ drawn from $\mathcal{D}$.

  We will use colours from a set of pairwise-disjoint \defin{palettes}, each of size $n^{1/3+\epsilon}$.  We will have a \defin{small} palette containing colours smaller than all those used in $\varphi$, a sequence of \defin{medium} palettes, each containing colours larger than all those used in $\varphi$.  In addition, we will have an extra palette of \defin{large} colours whose size is a random variable and whose values are larger than the colours in all other palettes. The palette of large colours is special in two ways:
  \begin{inparaenum}[(i)]
    \item each of its colours will be used to colour at most one vertex of $G$;
    \item its size is a random variable.
  \end{inparaenum}
  Note that, by (i), using a colour from the palette of large colours to colour a vertex $v$ is equivalent to removing $v$ from $G$.

 Throughout this proof, we will define a (random) us-colouring $\varphi'$ of $G$.\footnote{Add a footnote about how $\varphi'$ is really a distribution over us-colourings of $G$.}  Initially, we distinguish between two cases.
  If $|A|\le n^{1/3+\epsilon}$ then assign each vertex $a\in A$ a unique colour $\varphi'(a)$ from the palette of large colours.  Otherwise, we set $\varphi'(v):=\varphi(v)$ for each $v\in A$, but we may change this later.


  We say that a vertex $v\in B$ is \defin{unsafe} for $\varphi'$ if $v$ has two neighbours $x$ and $y$ with $\varphi'(x)=\varphi(y)'$, and $v$ is \defin{safe} otherwise.  Let $B_1$ be the subset of $B$ containing only the vertices that are unsafe for $\varphi$. For each $v\in B$, $\Pr(v\in B_1)\le \sum_{x,y\in \binom{N_G(v)}{2}}\Pr(\varphi(x)=\varphi(y))\le d^2 \alpha n^{-1/3-\epsilon/2}$.  Therefore $\E[|B_1|]\le d^2 \alpha n^{2/3-\epsilon/2}$.
  % Therefore, there exists a us-colouring $\varphi:A\to\{1,\ldots,k\}$ of $G[A]$ such that at most $d^2n^{2/3-\epsilon}$ vertices in $B$ are unsafe for $\varphi$. Fix such a $\varphi$.
  % Let $B_1$ be the set of vertices in $B$ that are unsafe for $\varphi$, so $\E[|B_1|]=??$.

  For each $v\in B\setminus B_1$, set $\varphi'(v)$ to be a uniformly random colour from the small palette.  Thus $\varphi'$ is a us-colouring of $G-B_1$.  What remains is to colour the vertices in $B_1$.  If $|A|\le n^{1/3+\epsilon}$ then every vertex in $B$ is safe, so this completes the colouring $\varphi'$ of $G$.  It is straightforward to verify that the distribution $\mathcal{D}'$ is $(cn^{1/3+\epsilon},\alpha n^{-1/3-\epsilon})$-good for any $\alpha \ge 1/c$.  Therefore, we now assume that $|A|\ge cn^{1/3+\epsilon})$.

  It is important at this point to deal with vertices of $A$ having many neighbours in $B_1$.  Let $A_1$ be the set of vertices in $A$ with at least $\Delta:=n^{1/3-3/2\epsilon}$ neighbours in $B_1$.  Then $|A_1|n^{1/3-2\epsilon}\le |B_1|$, so $\E[|A_1|]\le \E[|B_1|]n^{-1/3+3\epsilon/2}\le d^2\alpha n^{1/3+\epsilon}$.  We assign each vertex in $A_1$ a distinct colour from the palette of large colours.

  Suppose now that $B_1\supseteq B_2\supseteq \cdots\supseteq B_{i}$ are already defined and that $\varphi'$ is a us-colouring of $G-B_i$ using only colours from the small palette, colours from $\varphi(A)$, colours from the first $i-1$ medium palettes, and colours from the palette of large colours. In the following paragraphs, all probabilities are implicitly conditioned on this choice of $A_1$ and $B_i$.

  For each $v\in B_i$ we choose a random colour $\varphi'(v)$ from the $i$th palette.  Define a \defin{problem} to be a pair $(a,\{x,y\})$ with $a\in A\setminus A_i$, $x,y\in B_i$ with $x\neq y$, and $\varphi(x)=\varphi(y)$. For each $a\in A\setminus A_1$, let $\delta_a:= |N_G(a)\cap B_i|$.  For a particular $a\in A\setminus A_1$, the expected number of problems that involve $a$ is at most $\binom{\delta_a}{2}\cdot n^{-1/3-\epsilon}$. Therefore, the expected number of problems over all $a\in A\setminus A_1$ is at most\footnote{We point out again, that this expectation is taken in a probability space conditioned on a fixed choice of $A_1$ and $B_i$.}
  \begin{align*}
    n^{-1/3-\epsilon}\cdot\sum_{a\in A\setminus A_i} \delta_a^2 &
    \le n^{-1/3-\epsilon}\cdot \Delta^2 \cdot (d|B_i|/\Delta) \\
    & = d|B_i| n^{-1/3-\epsilon}\cdot \Delta \\
    & = d|B_i| n^{-3\epsilon}
  \end{align*}
  (The first inequality above is obtained by maximizing $\sum_{a\in A\setminus A_i} \delta_a^2$ subject to the global constraint $\sum_{a\in A\setminus A_i} \delta_a\le d|B_i|$ and the local constraints $\delta_a\le \Delta$ for each $a\in A\setminus A_i$.)

  Let $B_{i+1}\subseteq B_i$ be obtained by choosing, for each problem $(a,\{x,y\})$, a vertex $x$ or $y$ of $B_i$ included in the problem.  For each $b\in B_i\setminus B_{i+1}$ we fix the colour of $b$ and we are left with the problem of colouring the vertices in $B_{i+1}$.  The calculation above shows that, conditioned in $B_i$,
  \[
    E[|B_{i+1}|] \le d|B_i|n^{-3\epsilon}
  \]
  We continue until reaching a value $i^*$ such that $|B_{i^*}|\le n^{1/3}$.  When this occurs we colour every vertex in $B_{i^*}$ with a unique colour from the $i^*$th palette.  At this point $\varphi'$ is a us-colouring of $G$.

  We now show how to bound the expected number of colours used by $\varphi'$.  The first step is to upper bound the expected value of $i^*$.  To do this, we define, for each $i\in\N$, the indicator random variable
  \[
      I_i :=
        \begin{cases}
          0 & \text{if $i<i^*$ and $|B_{i+1}|> 2d|B_i|n^{-3\epsilon}$} \\
          1 & \text{if $i< i^*$ and $|B_{i+1}|\le 2d|B_i|n^{-3\epsilon}$} \\
          1 & \text{if $i\ge i^*$}
        \end{cases}
  \]
  Observe that $I_i=0$ only if $|B_{i+1}|$---conditioned on $B_i$---exceeds its expected value by at least a factor of $2$. Therefore, by Markov's Inequality, $\Pr(I_i=1)\ge 1/2$ for all $i\ge 1$.  Furtermore, for any binary sequence $I_{1},\ldots,I_{i-1}$, $\Pr(I_i=1\mid I_1,\ldots,I_{i-1})\ge 1/2$.  Therefore, for any integer $k\ge 1$, $X_k:=\sum_{i=1}^k I_i$ dominates a binomial$(k,1/2)$ random variable.  By a standard inequality, this implies that $\Pr(X_k\le k/4)\le e^{-k/8}$.

  Now observe that $|B_{i+1}|\le |B_i|$ for all $i\ge 1$. Using the convention that $|B_k|:=0$ for all $i>i^*$ we have,
  \[
    |B_{k+1}| \le (2d)^{X_k}\cdot |B_1|\cdot n^{-3\epsilon X_k} \le (2d)^{X_k}\cdot n^{1-3\epsilon X_k} < 1
  \]
  for all $k\ge k^* = ??$

  We can now analyze the expected number of colours used by $\varphi'$.  By definition, the expected number of colours used by $\varphi$ is $\beta$, and these are also used in $\varphi'$.  The expected number of colours from the large palette used to colour $A_1$ is at most $d^2\alpha n^{1/3+\epsilon}$.  The only remaining colours used from the first $i^*$ palettes, each of which contains $n^{1/3+\epsilon}$ colours.  The expected value of $i^*$ can be upper bounded as follows:
  \[
    \E[i^*] = \sum_{i=1}^\infty \Pr(i^*\ge i)
    \le \sum_{k=1}^{\infty} \Pr(B_k < k^*)
    \le 2k^* + \sum_{k=2k^*+1}^{\infty} \Pr(B_k < k^*)
    \le 2k^* + O(1) \enspace .
  \]
  Therefore, the expected number of colours used by $\varphi'$ is at most
  \[
     \beta + (d^2\alpha + k^*+O(1))n^{1/3+\epsilon} \enspace .
  \]
  Finally, it remains to bound $\Pr(\varphi'(v)=\varphi'(w))$ for any $v,w\in V(G)$.  There are only three possibilities:
  \begin{compactenum}
    \item $v,w\in A$ and $\varphi'(v)=\varphi(v)=\varphi(w)=\varphi'(w)$.  This occurs with probability at most $\Pr(\varphi(v)=\varphi(w))\le \beta$, by assumption.

    \item $v,w\in B\setminus B_1$.  In this case, $\varphi'(v)$ and $\varphi'(w)$ are assigned randomly from the palette of small colours.  This palette has size $n^{1/3+\epsilon}$, $\Pr(\varphi'(v)=\varphi'(w))\le n^{1/3+\epsilon} \le \alpha n^{1/3+\epsilon}$ for any $\alpha \le 1$.

    \item $v,w\in B_i\setminus B_{i+1}$ for some integer $i\ge 1$.  This probability takes more care because we repeatedly assign random colours to the vertices in $B_i$ and then reject some of these random choice and place the vertices into $B_{i+1}$.  Here we argue that this process happens in so few rounds that it does not significantly increase the probability of equality.  If $\phi'(v)=\varphi'(w)$ then at least one of the following events occurs:
    \begin{compactenum}
      \item the same colour is chosen for both $v$ and $w$ in some round $i\in\{1,\ldots,k^*+8\log n\}$, which occurs with probability at most $(2k^*+8\log n)n^{-1/3-\epsilon}<n^{-1/3-\epsilon/2}$; or

      \item $i^*\ge 2k^*+8\log n$, which occurs with probability at most $1/n$.
    \end{compactenum}
  \end{compactenum}
  Finish up....
\end{proof}

Our proof of \cref{d_degenerate_upper_bound} follows from the following stronger result by a trivial application of the probabilistic method.

\begin{lem}\label{d_degenerate_probabilistic}
  For any $\epsilon >0$ and any integer $d\ge 1$, there exists $c:=c(\epsilon,d)$, and $\alpha:=\alpha(\epsilon,d)$ such that for every integer $n\ge 1$, every $d$-degenerate graph $G$ with at most $n$ vertices is $(\beta+cn^{1/3+\epsilon},\alpha n^{-1/3-\epsilon/2})$-good.
\end{lem}


\begin{proof}
  Let $B:=\{v\in V(G):\deg(v)\le 4d\}$. Let $G'$ be the graph obtained from $G$ by removing each edge with both endpoints in $B$.


  Slice off all vertices of degree at most $4d$, call that set $B$, call the rest $A$, apply \cref{d_degenerate_upper_bound} and then properly colour the square of $G[B]$ and use that as part of a product colouring.
\end{proof}


\begin{proof}[Proof of \cref{d_degenerate_upper_bound}]
  By \cref{d_degenerate_probabilistic}, there exists a distribution $\mathcal{D}$ over us-colourings of $G$ such that the expected number of colours used in a us-colouring $\varphi$ drawn from $\mathcal{D}$ is at most $cn^{1/3+\epsilon}$.  Therefore $G$ has a us-colouring that uses at most $cn^{1/3+\epsilon}$ colours.
\end{proof}




\bibliographystyle{plainnat}
\bibliography{us2}



\end{document}
